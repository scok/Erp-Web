<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/sidebar}"
      xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/sb-admin-2.min.css}" rel="stylesheet">
    <link th:href="@{/css/table.css}" rel="stylesheet">
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>
    <script src="https://kit.fontawesome.com/549ed26fed.js" crossorigin="anonymous"></script>


    <script th:inline="javascript">

        $(document).ready(function(){
            var errorMessage = [[${errorMessage}]];
            if(errorMessage != null){
                alert(errorMessage);
            }
            bindDomEvent();

        });

        function bindDomEvent() {
          $(".memberImage").on("change", function() {
            var fileName = $(this).val().split("\\").pop();  // 이미지 파일명
            var fileExt = fileName.substring(fileName.lastIndexOf(".") + 1).toLowerCase(); // 확장자 추출

            if (fileExt != "jpg" && fileExt != "jpeg" && fileExt != "gif" && fileExt != "png" && fileExt != "bmp") {
              Swal.fire({
                icon: 'error',
                title: 'ERROR',
                text: '이미지 파일만 등록이 가능합니다.'
              });
              return;
            }

            $(this).siblings(".memberImage").html(fileName);
          });
        }

        function readImage(input) {
            if(input.files && input.files[0]) {
                const reader = new FileReader()

                reader.onload = e => {
                const previewImage = document.getElementById("preview-image")
                previewImage.src = e.target.result }

                reader.readAsDataURL(input.files[0])
            }
        }

        window.onload = function() {
            const inputImage = document.getElementById("memberImage")
            inputImage.addEventListener("change", e => {
            readImage(e.target)
            })
        };

    </script>

    <script>
        function sweetAlert(event) {
            event.preventDefault(); // 폼 제출 기본 동작 중지

            return new Promise((resolve) => {
                Swal.fire({
                    title: '수정 하시겠습니까?',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#73685d',
                    cancelButtonColor: '#6e7881',
                    confirmButtonText: 'OK',
                    cancelButtonText: 'Cancel'

                }).then((result) => {
                    if (result.isConfirmed) {
                        // MyDTO 객체 생성
                        const myDTO = {
                            password: document.getElementById('password').value,
                            name: document.getElementById('name').value,
                            birth: document.getElementById('birth').value,
                            email: document.getElementById('email').value,
                            phone: document.getElementById('phone').value,
                            address: document.getElementById('address').value,
                            date: document.getElementById('date').value,
                            department: document.getElementById('department').value,
                            position: document.getElementById('position').value,
                            hobong: document.getElementById('hobong').value,
                            bank: document.getElementById('bank').value,
                            status: document.getElementById('status').value,
                            role: document.getElementById('role').value,
                            memberImage: document.getElementById('memberImage').value
                        };

                        // 유효성 검사
                        const errors = validateMyDTO(myDTO);
                        if (errors.length > 0) {
                            // 오류 메시지 출력
                            Swal.fire({
                                title: 'Error',
                                icon: 'error',
                                html: errors[0],
                                confirmButtonColor: '#73685d'
                            });
                        } else {
                            Swal.fire({
                                title: 'Completed!',
                                icon: 'success',
                                confirmButtonColor: '#73685d'
                            }).then(() => {
                                // 폼을 수동으로 제출
                                event.target.form.submit();
                            });
                        }
                    }
                });
            });
        }


        // MyDTO 객체의 유효성 검사 함수
        function validateMyDTO(myDTO) {
            const errors = [];

            // 각 필드에 대한 유효성 검사
            if (!myDTO.memberImage) {
                errors.push('이미지를 등록 해 주세요.');
            }

            if (!myDTO.department) {
                errors.push('부서를 선택 해 주세요.');
            }

            if (!myDTO.position) {
                errors.push('직위를 선택 해 주세요.');
            }

            if (!myDTO.hobong) {
                errors.push('직급을 선택 해 주세요.');
            }

            if (!myDTO.role) {
                errors.push('구분은 필수 입력 값입니다.');
            }

            if (!myDTO.status) {
                errors.push('재직현황을 선택 해 주세요.');
            }

            if (!myDTO.name) {
                errors.push('이름은 필수 입력 값입니다.');
            }

            if (!myDTO.password) {
                errors.push('비밀번호는 8~16자 영문 대 소문자, 숫자, 특수문자를 사용해야 합니다.');
            } else if (!myDTO.password.match(/^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*\W)(?=\S+$).{8,16}$/)) {
                errors.push('비밀번호는 8~16자 영문 대 소문자, 숫자, 특수문자를 사용해야 합니다.');
            }

            if (!myDTO.birth) {
                errors.push('생년월일은 필수 입력 값입니다.');
            } else if (!myDTO.birth.match(/^\d{8}$/)) {
                errors.push('생년월일을 알맞게 입력해 주세요.');
            }

            if (!myDTO.address) {
                errors.push('주소는 필수 입력 값입니다.');
            }

            if (!myDTO.email) {
                errors.push('이메일은 필수 입력 값입니다.');
            } else if (!isValidEmail(myDTO.email)) {
                errors.push('이메일 형식으로 입력해 주세요.');
            }

            if (!myDTO.phone) {
                errors.push('핸드폰 번호는 필수 입력 값입니다.');
            } else if (!myDTO.phone.match(/^010\d{8}$/)) {
                errors.push('휴대폰 번호를 알맞게 입력해 주세요.');
            }

            if (!myDTO.bank) {
                errors.push('계좌번호는 필수 입력 값입니다.');
            }

            if (!myDTO.date) {
                errors.push('입사년월은 필수 입력 값입니다.');
            }

        return errors;
        }

        // 이메일 유효성 검사 함수
        function isValidEmail(email) {
            // 간단한 이메일 유효성 검사를 수행하는 정규식
            const emailRegex = /^[^\s@]+@[^\s@]+.[^\s@]+$/;
            return emailRegex.test(email);
        }

    </script>

    <script>
    // 소트후 효과
        function handleClickEvent() {
          var isMouseDown = false;

          // 마우스를 올렸을 때
          $('table tr.odd').mouseover(function() {
            if (isMouseDown) {
              $(this).addClass('clicked');
            } else {
              $(this).addClass('highlight');
            }
          });

          // 마우스를 떼었을 때
          $('table tr.odd').mouseout(function() {
            if (!$(this).hasClass('clicked')) {
              $(this).removeClass('highlight');
            }
          });

          // 마우스를 누르고 있을 때
          $('table tr.odd').mousedown(function() {
            isMouseDown = true;
            $('table tr.odd').removeClass('clicked');
            $(this).addClass('clicked');
          });

          // 마우스를 떼었을 때
          $('table tr.odd').mouseup(function() {
            isMouseDown = false;
            $(this).removeClass('clicked');
          });

          // tr.odd 범위를 벗어났을 때
          $(document).mouseup(function() {
            isMouseDown = false;
            $('table tr.odd').removeClass('clicked');
            $('table tr.odd').removeClass('highlight');
          });
        }
    // 화살표 소트
        $(document).ready(function() {
          $('thead th').click(function() {
            var $th = $(this);
            var $table = $th.closest('table');

            if ($th.hasClass('sorting_asc')) {
              $th.removeClass('sorting_asc').addClass('sorting_desc');
              sortColumn($table, $th.index(), 'desc');
            } else if ($th.hasClass('sorting_desc')) {
              $th.removeClass('sorting_desc').addClass('sorting_asc');
              sortColumn($table, $th.index(), 'asc');
            } else {
              $table.find('thead th').removeClass('sorting_asc sorting_desc');
              $th.addClass('sorting_asc');
              sortColumn($table, $th.index(), 'asc');
            }
            handleClickEvent();
          });

          function sortColumn($table, columnIndex, sortDirection) {
            var $tbody = $table.find('tbody');
            var rows = $tbody.find('tr').get();

            rows.sort(function(a, b) {
              var aValue = $(a).find('td').eq(columnIndex).text().toUpperCase();
              var bValue = $(b).find('td').eq(columnIndex).text().toUpperCase();

              if (sortDirection === 'asc') {
                if ($.isNumeric(aValue) && $.isNumeric(bValue)) {
                  return parseFloat(aValue) - parseFloat(bValue);
                } else {
                  return aValue.localeCompare(bValue);
                }
              } else {
                if ($.isNumeric(aValue) && $.isNumeric(bValue)) {
                  return parseFloat(bValue) - parseFloat(aValue);
                } else {
                  return bValue.localeCompare(aValue);
                }
              }
            });

            $tbody.empty();

            $.each(rows, function(index, row) {
              $tbody.append(row);
            });
          }
        });
    </script>

    <script src="http://dmaps.daum.net/map_js_init/postcode.v2.js"></script>
    <script>
        function searchAddress() {
        event.preventDefault(); // 폼 제출 기본 동작 중지
            new daum.Postcode({
                oncomplete: function(data) {
                    document.getElementById('address').value = data.address;
                }
            }).open({
                popupTitle: '주소 검색',
                popupKey: 'popup1',
                autoClose: true
            });
        }
    </script>

    <script>
          // 모달 열기
          function openModal() {
            document.getElementById("myModal").style.display = "block";
            document.addEventListener("keydown", closeModalOnEscape);
            document.addEventListener("click", closeModalOnClickOutside);
          }

          // 모달 닫기
          function closeModal() {
            document.getElementById("myModal").style.display = "none";
            document.removeEventListener("keydown", closeModalOnEscape);
            document.removeEventListener("click", closeModalOnClickOutside);
          }

          // ESC 키를 누를 때 모달 닫기
          function closeModalOnEscape(event) {
            if (event.key === "Escape") {
              closeModal();
            }
          }

          // 모달 바깥 영역을 클릭할 때 모달 닫기
          function closeModalOnClickOutside(event) {
            if (event.target === document.getElementById("myModal")) {
              closeModal();
            }
          }



    </script>

    <script>
          // 모달 열기
          function openModal2() {
            document.getElementById("myModal2").style.display = "block";
            document.addEventListener("keydown", closeModalOnEscape2);
            document.addEventListener("click", closeModalOnClickOutside2);
          }

          // 모달 닫기
          function closeModal2() {
            document.getElementById("myModal2").style.display = "none";
            document.removeEventListener("keydown", closeModalOnEscape2);
            document.removeEventListener("click", closeModalOnClickOutside2);
          }

          // ESC 키를 누를 때 모달 닫기
          function closeModalOnEscape2(event) {
            if (event.key === "Escape") {
              closeModal2();
            }
          }

          // 모달 바깥 영역을 클릭할 때 모달 닫기
          function closeModalOnClickOutside2(event) {
            if (event.target === document.getElementById("myModal2")) {
              closeModal2();
            }
          }

    </script>

    <script>
        //급여수정

          // 모달 열기
          function openModal4() {
            document.getElementById("myModal4").style.display = "block";
            document.addEventListener("keydown", closeModalOnEscape4);
            document.addEventListener("click", closeModalOnClickOutside4);
          }

          // 모달 닫기
          function closeModal4() {
            document.getElementById("myModal4").style.display = "none";
            document.removeEventListener("keydown", closeModalOnEscape4);
            document.removeEventListener("click", closeModalOnClickOutside4);
          }

          // ESC 키를 누를 때 모달 닫기
          function closeModalOnEscape4(event) {
            if (event.key === "Escape") {
              closeModal4();
            }
          }

          // 모달 바깥 영역을 클릭할 때 모달 닫기
          function closeModalOnClickOutside4(event) {
            if (event.target === document.getElementById("myModal4")) {
              closeModal4();
            }
          }



    </script>



    <script>
      $(document).ready(function() {
        var isMouseDown = false;

        // 마우스를 올렸을 때
        $('table tr.odd').mouseover(function() {
          if (isMouseDown) {
            $(this).addClass('clicked');
          } else {
            $(this).addClass('highlight');
          }
        });

        // 마우스를 떼었을 때
        $('table tr.odd').mouseout(function() {
          if (!$(this).hasClass('clicked')) {
            $(this).removeClass('highlight');
          }
        });

        // 마우스를 누르고 있을 때
        $('table tr.odd').mousedown(function() {
          isMouseDown = true;
          $('table tr.odd').removeClass('clicked');
          $(this).addClass('clicked');
        });

        // 마우스를 떼었을 때
        $('table tr.odd').mouseup(function() {
          isMouseDown = false;
          $(this).removeClass('clicked');
        });

        // tr.odd 범위를 벗어났을 때
        $(document).mouseup(function() {
          isMouseDown = false;
          $('table tr.odd').removeClass('clicked');
          $('table tr.odd').removeClass('highlight');
        });
      });
    </script>

    <script>
        // 급여디테일 값 표기
        function handleRowClick(row) {
            var tdRegDate = row.getElementsByTagName("td")[0].innerText;

            var tdPlusMoney = row.getElementsByTagName("td")[1].innerText;
            var tdMinusMoney = row.getElementsByTagName("td")[2].innerText;
            var tdTotalMoney = row.getElementsByTagName("td")[3].innerText;
            var tdPayId = row.getElementsByTagName("td")[4].innerText;

            var tdsalary = row.getElementsByTagName("td")[5].innerText;
            var tdBonus = row.getElementsByTagName("td")[6].innerText;
            var tdNightPay = row.getElementsByTagName("td")[7].innerText;
            var tdFoodPay = row.getElementsByTagName("td")[8].innerText;
            var tdCarPay = row.getElementsByTagName("td")[9].innerText;
            var tdGoInsurance = row.getElementsByTagName("td")[10].innerText;
            var tdGunInsurance = row.getElementsByTagName("td")[11].innerText;
            var tdSanInsurance = row.getElementsByTagName("td")[12].innerText;
            var tdKukInsurance = row.getElementsByTagName("td")[13].innerText;
            var tdIncomeTax = row.getElementsByTagName("td")[14].innerText;
            var tdLocalTax = row.getElementsByTagName("td")[15].innerText;
            var tdId = row.getElementsByTagName("td")[16].innerText;

            //00년 00월 급여명세서 (급여 디테일)
            document.getElementById("detailRegDate").innerText = tdRegDate + " 급여명세서";
            //00년 00월 급여명세서 (급여 수정)
            document.getElementById("updateRegdate").innerText = tdRegDate + " 급여명세서";

            document.getElementById("detailPlusMoney").innerText = tdPlusMoney;
            document.getElementById("detailMinusMoney").innerText = tdMinusMoney;
            document.getElementById("detailTotalMoney").innerText = tdTotalMoney;

            document.getElementById("detailSalary").innerText = formatNumber(tdsalary) + "원";
            document.getElementById("detailBonus").innerText = formatNumber(tdBonus) + "원";
            document.getElementById("detailNightPay").innerText = formatNumber(tdNightPay) + "원";
            document.getElementById("detailFoodPay").innerText = formatNumber(tdFoodPay) + "원";
            document.getElementById("detailCarPay").innerText = formatNumber(tdCarPay) + "원";
            document.getElementById("detailGoInsurance").innerText = formatNumber(tdGoInsurance) + "원";
            document.getElementById("detailGunInsurance").innerText = formatNumber(tdGunInsurance) + "원";
            document.getElementById("detailSanInsurance").innerText = formatNumber(tdSanInsurance) + "원";
            document.getElementById("detailKukInsurance").innerText = formatNumber(tdKukInsurance) + "원";
            document.getElementById("detailIncomeTax").innerText = formatNumber(tdIncomeTax) + "원";
            document.getElementById("detailLocalTax").innerText = formatNumber(tdLocalTax) + "원";

            var form = document.getElementById("myForm"); // 폼의 ID를 지정해야 합니다.
            form.action = "/members/admin/payUpdateNew/" + tdId + "/" + tdPayId;

            openModal3(); // 페이지 이동 후 모달 열기 함수를 호출합니다.

            // 급여 수정 값 넣어주기

            var salaryUpdate = row.getElementsByTagName("td")[5].innerText;
            var bonusUpdate = row.getElementsByTagName("td")[6].innerText;
            var nightPayUpdate = row.getElementsByTagName("td")[7].innerText;
            var foodPayUpdate = row.getElementsByTagName("td")[8].innerText;
            var carPayUpdate = row.getElementsByTagName("td")[9].innerText;

            document.getElementById("salaryUpdate").value = formatNumber(salaryUpdate);
            document.getElementById("bonusUpdate").value = formatNumber(bonusUpdate);
            document.getElementById("nightPayUpdate").value = formatNumber(nightPayUpdate);
            document.getElementById("foodPayUpdate").value = formatNumber(foodPayUpdate);
            document.getElementById("carPayUpdate").value = formatNumber(carPayUpdate);

        }; //급여디테일 값 표기 닫는 태그


        // 모달 열기
        function openModal3() {
            document.getElementById("myModal3").style.display = "block";
            document.addEventListener("keydown", closeModalOnEscape3);
            document.addEventListener("click", closeModalOnClickOutside3);
        }

        // 모달 닫기
        function closeModal3() {
            document.getElementById("myModal3").style.display = "none";
            document.removeEventListener("keydown", closeModalOnEscape3);
            document.removeEventListener("click", closeModalOnClickOutside3);
        }

        // ESC 키를 누를 때 모달 닫기
        function closeModalOnEscape3(event) {
            if (event.key === "Escape") {
                closeModal3();
            }
        }


        // 모달 바깥 영역을 클릭할 때 모달 닫기
        function closeModalOnClickOutside3(event) {
            if (event.target === document.getElementById("myModal3")) {
                closeModal3();
            }
        }
    </script>

    <script>
    // 급여 수정 계산기 함수
    var payUpdateTotal = 0;

    function updateCalculateTotal() {
    console.log('수정 계산기 호출됨');
    var inputs = document.querySelectorAll('#payUpdateTable1 input[type="text"]');
    var totalPrice = 0;
    for (var i = 0; i < inputs.length; i++) {
    var value = parseFloat(inputs[i].value.replace(/,/g, '')); // 쉼표 제거 후 숫자로 변환
    if (!isNaN(value)) {
    totalPrice += value;
     }
    }
    payUpdateTotal = totalPrice;
    $('input[name="plusMoney"]').val(payUpdateTotal);
    document.getElementById('payUpdateTotal').textContent = formatNumber(totalPrice) + '원';

    //급여 수정 세금 계산 함수 호출
    updateTaxCalculate();

    // 급여 수정 차감지급액 업데이트 함수 호출
    updateDeductionTotal2();

    }

    function formatNumber(number) {
    return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }

    // 급여 수정 차감지급액 업데이트 함수
    function updateDeductionTotal2() {
    var deductionTotal = payUpdateTotal - updatetotalTax;
    $('input[name="TotalMoney"]').val(deductionTotal.toFixed(0));
    document.getElementById('deductionTotal2').textContent = formatNumber(deductionTotal.toFixed(0)) + '원';
    console.log('수정업데이트?');
    console.log('payUpdateTotal'+payUpdateTotal);
    console.log('updatetotalTax'+updatetotalTax);
    console.log('deductionTotal'+deductionTotal);
    }

    // 급여 수정 세금 계산 함수
    var updatetotalTax = 0;
    function updateTaxCalculate(){
    console.log('세금 계산 함수');
    var inputs = document.querySelectorAll('#payUpdateTable1 input[type="text"]');
    var goInsurance = 0;
    var gunInsurance = 0;
    var sanInsurance = 0;
    var kukInsurance = 0;
    var incomeTax = 0;
    var localTax = 0;

    for (var i = 0; i < inputs.length; i++) {
    var value = parseFloat(inputs[i].value.replace(/,/g, '')); // 쉼표 제거 후 숫자로 변환
    if (!isNaN(value)) {
    // 공제항목 소숫점 반올림
    goInsurance += parseFloat((value * 0.009).toFixed(0));
    gunInsurance += parseFloat((value * 0.035).toFixed(0));
    sanInsurance += parseFloat((value * 0.014).toFixed(0));
    kukInsurance += parseFloat((value * 0.045).toFixed(0));
    incomeTax += parseFloat((value * 0.01).toFixed(0));
    localTax += parseFloat((value * 0.01).toFixed(0));
    }
    $('input[name="goInsurance"]').val(goInsurance);
    $('input[name="gunInsurance"]').val(gunInsurance);
    $('input[name="sanInsurance"]').val(sanInsurance);
    $('input[name="kukInsurance"]').val(kukInsurance);
    $('input[name="incomeTax"]').val(incomeTax);
    $('input[name="localTax"]').val(localTax);


    updatetotalTax = goInsurance + gunInsurance + sanInsurance + kukInsurance + incomeTax + localTax;
    $('input[name="minusMoney"]').val(updatetotalTax);
    }
    document.getElementById('goInsuranceUpdate').textContent = formatNumber(goInsurance) + '원';
    document.getElementById('gunInsuranceUpdate').textContent = formatNumber(gunInsurance) + '원';
    document.getElementById('sanInsuranceUpdate').textContent = formatNumber(sanInsurance) + '원';
    document.getElementById('kukInsuranceUpdate').textContent = formatNumber(kukInsurance) + '원';
    document.getElementById('incomeTaxUpdate').textContent = formatNumber(incomeTax) + '원';
    document.getElementById('localTaxUpdate').textContent = formatNumber(localTax) + '원';
    document.getElementById('updateMinusMoney').textContent = formatNumber(updatetotalTax) + '원';
    } // 세금 계산 함수 닫는 태그
    </script>

    <script>
      // 화면에 있는 ,를 제거해주는 함수 (급여수정)
      function calculateTotal88() {
        var inputs = document.querySelectorAll('#payUpdateTable1 input[type="text"]');
        var salary = 0;
        var bonus = 0;
        var nightPay = 0;
        var foodPay = 0;
        var carPay = 0;

        for (var i = 0; i < inputs.length; i++) {
          var value = parseFloat(inputs[i].value.replace(/,/g, '')); // 쉼표 제거 후 숫자로 변환
          if (!isNaN(value)) {

            if (inputs[i].id === "salaryUpdate") {
              salary = value;

            } else if (inputs[i].id === "bonusUpdate") {
              bonus = value;
            } else if (inputs[i].id === "nightPayUpdate") {
              nightPay = value;
            } else if (inputs[i].id === "foodPayUpdate") {
              foodPay = value;
            } else if (inputs[i].id === "carPayUpdate") {
              carPay = value;
            }
          }
        }
          $('input[name="salary"]').val(salary);
          $('input[name="bonus"]').val(bonus);
          $('input[name="nightPay"]').val(nightPay);
          $('input[name="foodPay"]').val(foodPay);
          $('input[name="carPay"]').val(carPay);

      }

      // 급여 수정 폼 전송 함수
      function sweetAlert3(event) {
            event.preventDefault(); // 폼 제출 기본 동작 중지
            console.log('급여 수정 폼 제출 기본 동작 중지');

            return new Promise((resolve) => {
                Swal.fire({
                    title: '급여를 수정 하시겠습니까?',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#73685d',
                    cancelButtonColor: '#6e7881',
                    confirmButtonText: 'OK',
                    cancelButtonText: 'Cancel'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // MyDTO3 객체 생성
                        const payUpdateTotal = parseFloat(document.getElementById('payUpdateTotal').textContent.replace(/[^0-9.-]+/g, '')); // payUpdateTotal 값 가져오기
                        const updateMinusMoney = parseFloat(document.getElementById('updateMinusMoney').textContent.replace(/[^0-9.-]+/g, '')); // updateMinusMoney 값 가져오기
                        const deductionTotal2 = payUpdateTotal - updateMinusMoney;

                        const MyDTO3 = {
                            salary: document.getElementById('salaryUpdate').value.replace(/,/g, ''),
                            bonus: document.getElementById('bonusUpdate').value.replace(/,/g, ''),
                            nightPay: document.getElementById('nightPayUpdate').value.replace(/,/g, ''),
                            foodPay: document.getElementById('foodPayUpdate').value.replace(/,/g, ''),
                            carPay: document.getElementById('carPayUpdate').value.replace(/,/g, ''),
                            plusMoney: payUpdateTotal,
                            minusMoney: updateMinusMoney,
                            TotalMoney: deductionTotal2
                        };

                        // 유효성 검사
                        const errors = validateMyDTO3(MyDTO3);
                        if (errors.length > 0) {
                            // 오류 메시지 출력
                            Swal.fire({
                                title: 'Error',
                                icon: 'error',
                                html: errors[0],
                                confirmButtonColor: '#73685d'
                            });
                        } else {
                            // ,를 제거해주는 함수 호출
                            calculateTotal88();

                            Swal.fire({
                                title: 'Completed!',
                                icon: 'success',
                                confirmButtonColor: '#73685d'
                            }).then(() => {
                                // 폼을 수동으로 제출
                                event.target.form.submit();
                            });
                        }
                    }
                });
            });
        }
        // MyDTO3 객체의 유효성 검사 함수
        function validateMyDTO3(myDTO3) {
            const errors = [];

            // 각 필드에 대한 유효성 검사
            if (!myDTO3.salary) {
                errors.push('기본급을 입력해 주세요.');
            }else if (isNaN(myDTO3.salary) || myDTO3.salary.trim() === ''){
                errors.push('기본급을 숫자로 입력해 주세요.');
            }

            if (!myDTO3.bonus) {
                errors.push('상여금을 입력해 주세요.');
            }else if (isNaN(myDTO3.bonus) || myDTO3.bonus.trim() === ''){
                errors.push('상여금을 숫자로 입력해 주세요.');
            }

            if (!myDTO3.nightPay) {
                errors.push('야근수당을 입력해 주세요.');
            }else if (isNaN(myDTO3.nightPay) || myDTO3.nightPay.trim() === ''){
                errors.push('야근수당을 숫자로 입력해 주세요.');
            }

            if (!myDTO3.foodPay) {
                errors.push('식비를 입력해 주세요.');
            }else if (isNaN(myDTO3.foodPay) || myDTO3.foodPay.trim() === ''){
                errors.push('식비를 숫자로 입력해 주세요.');
            }

            if (!myDTO3.carPay) {
                errors.push('차량지원금을 입력해 주세요.');
            }else if (isNaN(myDTO3.carPay) || myDTO3.carPay.trim() === ''){
                errors.push('차량지원금을 숫자로 입력해 주세요.');
            }
            return errors;
        }
    </script>


    <script th:inline="javascript">
    document.addEventListener('DOMContentLoaded', function() {
        var now = new Date();
        var year = now.getFullYear().toString().substring(2); // 뒤의 두 자리만 추출
        var month = (now.getMonth() + 1).toString().padStart(2, '0'); // 1월은 0으로 시작하므로 +1, 한 자리인 경우 앞에 0 추가
        var title = document.getElementById('datetitle'); // 요소 찾기
        title.innerText = year + '년 ' + month + '월 급여명세서'; // 내용 변경
        });

    // 급여리스트에 ,를 붙여주는 함수
        $(document).ready(function() {
         $(".pp").each(function() {
            var plusMoney = $(this).text();
            var formattedPlusMoney = formatNumber(plusMoney) + "원";
         $(this).text(formattedPlusMoney);
        });

        $(".mm").each(function() {
        var minusMoney = $(this).text();
        var formattedMinusMoney = formatNumber(minusMoney) + "원";
        $(this).text(formattedMinusMoney);
        });

        $(".tt").each(function() {
        var totalMoney = $(this).text();
        var formattedTotalMoney = formatNumber(totalMoney) + "원";
        $(this).text(formattedTotalMoney);
        });
        });

        function formatNumber(number) {
            return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
// 급여리스트에 ,를 붙여주는 함수 끝

        // 지급항목 테이블에 입력된 숫자를 합산하는 함수
        var totalPrice3 = 0;
        function calculateTotal() {
        console.log('계산기1 호출됨');
          var inputs = document.querySelectorAll('#dataTable1 input[type="text"]');
          var totalPrice = 0;
          for (var i = 0; i < inputs.length; i++) {
            var value = parseFloat(inputs[i].value.replace(/,/g, '')); // 쉼표 제거 후 숫자로 변환
            if (!isNaN(value)) {
              totalPrice += value;
            }
          }
          totalPrice3 = totalPrice;
          $('input[name="plusMoney"]').val(totalPrice3);
          document.getElementById('totalPrice').textContent = formatNumber(totalPrice) + '원';

          // 세금 계산 함수 호출
          taxCalculate();

          // 차감지급액 업데이트 함수 호출
          updateDeductionTotal();

        }

        function formatNumber(number) {
          return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        // 차감지급액 업데이트 함수
        function updateDeductionTotal() {
          var deductionTotal = totalPrice3 - totalTax;
          $('input[name="TotalMoney"]').val(deductionTotal.toFixed(0));
          document.getElementById('deductionTotal').textContent = formatNumber(deductionTotal.toFixed(0)) + '원';
          console.log('업데이트?');
        }

        // 세금 계산 함수
        var totalTax = 0;
        function taxCalculate(){
         console.log('세금 계산 함수');
          var inputs = document.querySelectorAll('#dataTable1 input[type="text"]');
          var goInsurance = 0;
          var gunInsurance = 0;
          var sanInsurance = 0;
          var kukInsurance = 0;
          var incomeTax = 0;
          var localTax = 0;

          for (var i = 0; i < inputs.length; i++) {
            var value = parseFloat(inputs[i].value.replace(/,/g, '')); // 쉼표 제거 후 숫자로 변환
            if (!isNaN(value)) {
              // 공제항목 소숫점 반올림
              goInsurance += parseFloat((value * 0.009).toFixed(0));
              gunInsurance += parseFloat((value * 0.035).toFixed(0));
              sanInsurance += parseFloat((value * 0.014).toFixed(0));
              kukInsurance += parseFloat((value * 0.045).toFixed(0));
              incomeTax += parseFloat((value * 0.01).toFixed(0));
              localTax += parseFloat((value * 0.01).toFixed(0));
            }
            $('input[name="goInsurance"]').val(goInsurance);
            $('input[name="gunInsurance"]').val(gunInsurance);
            $('input[name="sanInsurance"]').val(sanInsurance);
            $('input[name="kukInsurance"]').val(kukInsurance);
            $('input[name="incomeTax"]').val(incomeTax);
            $('input[name="localTax"]').val(localTax);

            totalTax = goInsurance + gunInsurance + sanInsurance + kukInsurance + incomeTax + localTax;
            $('input[name="minusMoney"]').val(totalTax);
          }
          document.getElementById('goInsurance').textContent = formatNumber(goInsurance) + '원';
          document.getElementById('gunInsurance').textContent = formatNumber(gunInsurance) + '원';
          document.getElementById('sanInsurance').textContent = formatNumber(sanInsurance) + '원';
          document.getElementById('kukInsurance').textContent = formatNumber(kukInsurance) + '원';
          document.getElementById('incomeTax').textContent = formatNumber(incomeTax) + '원';
          document.getElementById('localTax').textContent = formatNumber(localTax) + '원';
          document.getElementById('totalPrice2').textContent = formatNumber(totalTax) + '원';
        } // 세금 계산 함수 닫는 태그
    </script>

    <script>
      // 화면에 있는 ,를 제거해주는 함수
      function calculateTotal99() {
        var inputs = document.querySelectorAll('#dataTable1 input[type="text"]');
        var salary = 0;
        var bonus = 0;
        var nightPay = 0;
        var foodPay = 0;
        var carPay = 0;

        for (var i = 0; i < inputs.length; i++) {
          var value = parseFloat(inputs[i].value.replace(/,/g, '')); // 쉼표 제거 후 숫자로 변환
          if (!isNaN(value)) {

            if (inputs[i].id === "salary") {
              salary = value;
            } else if (inputs[i].id === "bonus") {
              bonus = value;
            } else if (inputs[i].id === "nightPay") {
              nightPay = value;
            } else if (inputs[i].id === "foodPay") {
              foodPay = value;
            } else if (inputs[i].id === "carPay") {
              carPay = value;
            }
          }
        }
          $('input[name="salary"]').val(salary);
          $('input[name="bonus"]').val(bonus);
          $('input[name="nightPay"]').val(nightPay);
          $('input[name="foodPay"]').val(foodPay);
          $('input[name="carPay"]').val(carPay);
      }

      // 오늘 날짜를 가져오는 함수
       function getFormattedDate() {
          var today = new Date();
          var year = today.getFullYear().toString().substr(-2); // 뒤에서 2자리만 추출
          var month = (today.getMonth() + 1).toString().padStart(2, '0'); // 0부터 시작하므로 +1, 2자리로 맞춤
          var formattedDate = year + '년 ' + month + '월';
          return formattedDate;
       }

        // 변수에 오늘 날짜 대입
        var currentDate = getFormattedDate();

        // 출력
        console.log(currentDate);


      // 마지막 폼 전송 함수
      function sweetAlert2(event) {
            event.preventDefault(); // 폼 제출 기본 동작 중지
            console.log('폼 제출 기본 동작 중지');
            return new Promise((resolve) => {
                Swal.fire({
                    title: '등록 하시겠습니까?',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#73685d',
                    cancelButtonColor: '#6e7881',
                    confirmButtonText: 'OK',
                    cancelButtonText: 'Cancel'

                }).then((result) => {
                    if (result.isConfirmed) {
                        // MyDTO2 객체 생성
                        const totalPrice3 = parseFloat(document.getElementById('totalPrice').textContent.replace(/[^0-9.-]+/g, '')); // totalPrice3 값 가져오기
                        const totalPrice4 = parseFloat(document.getElementById('totalPrice2').textContent.replace(/[^0-9.-]+/g, '')); // totalPrice4 값 가져오기
                        const deductionTotal = totalPrice3 - totalPrice4;
                        const regDateValue = $('#xxx').text();

                        const MyDTO2 = {
                            salary: document.getElementById('salary').value.replace(/,/g, ''),
                            bonus: document.getElementById('bonus').value.replace(/,/g, ''),
                            nightPay: document.getElementById('nightPay').value.replace(/,/g, ''),
                            foodPay: document.getElementById('foodPay').value.replace(/,/g, ''),
                            carPay: document.getElementById('carPay').value.replace(/,/g, ''),
                            plusMoney: totalPrice3,
                            minusMoney: totalPrice4,
                            TotalMoney: deductionTotal,
                            regDate: regDateValue
                        };

                        // 유효성 검사
                        const errors = validateMyDTO2(MyDTO2);
                        if (errors.length > 0) {
                            // 오류 메시지 출력
                            Swal.fire({
                                title: 'Error',
                                icon: 'error',
                                html: errors[0],
                                confirmButtonColor: '#73685d'
                            });
                        } else {
                            // ,를 제거해주는 함수 호출
                            calculateTotal99();

                            Swal.fire({
                                title: 'Completed!',
                                icon: 'success',
                                confirmButtonColor: '#73685d'
                            }).then(() => {
                                // 폼을 수동으로 제출
                                event.target.form.submit();
                            });
                        }
                    }
                });
            });
        }
        // MyDTO2 객체의 유효성 검사 함수
        function validateMyDTO2(myDTO2) {
            const errors = [];

            // 각 필드에 대한 유효성 검사
            if (myDTO2.regDate===currentDate) {
                errors.push('이미 급여가 있습니다.');
            }

            // 각 필드에 대한 유효성 검사
            if (!myDTO2.salary) {
                errors.push('기본급을 입력해 주세요.');
            }else if (isNaN(myDTO2.salary) || myDTO2.salary.trim() === ''){
                errors.push('기본급을 숫자로 입력해 주세요.');
            }

            if (!myDTO2.bonus) {
                errors.push('상여금을 입력해 주세요.');
            }else if (isNaN(myDTO2.bonus) || myDTO2.bonus.trim() === ''){
                errors.push('상여금을 숫자로 입력해 주세요.');
            }

            if (!myDTO2.nightPay) {
                errors.push('야근수당을 입력해 주세요.');
            }else if (isNaN(myDTO2.nightPay) || myDTO2.nightPay.trim() === ''){
                errors.push('야근수당을 숫자로 입력해 주세요.');
            }

            if (!myDTO2.foodPay) {
                errors.push('식비를 입력해 주세요.');
            }else if (isNaN(myDTO2.foodPay) || myDTO2.foodPay.trim() === ''){
                errors.push('식비를 숫자로 입력해 주세요.');
            }

            if (!myDTO2.carPay) {
                errors.push('차량지원금을 입력해 주세요.');
            }else if (isNaN(myDTO2.carPay) || myDTO2.carPay.trim() === ''){
                errors.push('차량지원금을 숫자로 입력해 주세요.');
            }
        return errors;
        }
    </script>




</head>

<div class="content" layout:fragment="content">
    <body class="background-color-white">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-5">
                <div class="card-body p-51">
                    <!-- Nested Row within Card Body -->
                    <form action="" role="form" method="post" th:object="${memberDetailDto}" id="myFormId" enctype="multipart/form-data">
                        <!-- DataTales Example -->
                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h6 class="m-0 font-weight-bold text-brown">Employee Information</h6>
                            </div>
                            <div class="card-body3">

                                <div class="row gx-3 mb-3">
                                    <div class="col-md-6" style="text-align: center;">
                                        <div class="image-container">
                                            <img style="width: 250px;height: 280px;margin-top:-18px; border: 1px solid #d1d3e2;border-radius: 0.35rem;"
                                                 th:src="${memberDetailDto.imageUrl}">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="small mb-1">Name</label>
                                        <br/>
                                        <span th:text="*{name}"/>
                                        <hr class="mt-2 mb-2">
                                        <label class="small mb-1">Birth</label>
                                        <br/>
                                        <span th:text="|${#strings.substring(memberDetailDto.birth, 0, 4)}년${#strings.substring(memberDetailDto.birth, 4, 6)}월${#strings.substring(memberDetailDto.birth, 6, 8)}일|"/>
                                        <hr class="mt-2 mb-2">
                                        <label class="small mb-1">Phone number</label>
                                        <br/>
                                        <span th:text="|${#strings.substring(memberDetailDto.phone, 0, 3)}-${#strings.substring(memberDetailDto.phone, 3, 7)}-${#strings.substring(memberDetailDto.phone, 7, 11)}|"/>
                                        <hr class="mt-2 mb-2">
                                        <label class="small mb-1">Email</label>
                                        <br/>
                                        <span th:text="*{email}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                </div>

                                <div class="row gx-3 mb-3">
                                    <div class="col-md-6">
                                        <label class="small mb-1">address</label>
                                        <br/>
                                        <span th:text="*{address}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="small mb-1">Bank account</label>
                                        <br/>
                                        <span th:text="*{bank}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                </div>

                                <div class="row gx-3 mb-3">
                                    <div class="col-md-4">
                                        <label class="small mb-1">Department</label>
                                        <br/>
                                        <span th:text="*{department}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="small mb-1">Spot</label>
                                        <br/>
                                        <span th:text="*{position}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="small mb-1">Rank</label>
                                        <br/>
                                        <span th:text="*{hobong}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                </div>

                                <div class="row gx-3 mb-3">
                                    <div class="col-md-4">
                                        <label class="small mb-1">Joining date</label>
                                        <br/>
                                        <span th:text="${#temporals.format(memberDetailDto.date, 'yyyy년MM월dd일')}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="small mb-1">Employment status</label>
                                        <br/>
                                        <span th:text="*{status == T(com.Erp.constant.MemberStatus).WORKING ? '재직중' : '퇴사'}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="small mb-1">Role</label>
                                        <br/>
                                        <span th:text="*{role == T(com.Erp.constant.MemberRole).ADMIN ? '관리자' : '사용자'}"/>
                                        <hr class="mt-2 mb-2">
                                    </div>
                                </div>
                                &nbsp;&nbsp;&nbsp;
                                <!-- Save changes button-->
                                <div class="button-container">
                                    <button type="button" class="btn btn-background-brown btn-user" style="width:150px;" onclick="openModal()">
                                        Edit
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>

                    <!-- 직원 수정 모달 -->
                    <div id="myModal" class="modal">
                        <div class="modal-content">
                            <div class="card o-hidden border-0 shadow-lg my-3">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-brown">Edit Employee</h6>
                                </div>
                                <div class="close-button" onclick="closeModal()"><i class="fa-solid fa-xmark"></i></div>
                                <div class="card-body p-50">
                                    <form action="" role="form" method="post" th:object="${memberUpdateDto}" enctype="multipart/form-data">
                                        <div class="card mb-4">

                                            <div class="card-body3">
                                                <div class="row gx-3 mb-3">
                                                    <div class="col-md-5" style="text-align: center; margin-top:40px; margin-bottom:-40px;">
                                                        <div class="image-container">
                                                            <label for="memberImage">
                                                                <img style="width: 250px;height: 280px;margin-top:-18px; border: 1px solid #d1d3e2;border-radius: 0.35rem;" id="preview-image"
                                                                     th:src="${memberUpdateDto.imageUrl}">
                                                                <input style="display:block;" type="file" class ="memberImage" id="memberImage" name="memberImage">
                                                            </label>
                                                        </div>
                                                    </div>

                                                    <div class="col-md-7">
                                                        <label class="small mb-1" th:for="name">Name</label>
                                                        <input type="text" class="form-control form-control-user" th:field="*{name}"
                                                               placeholder="이름">

                                                        <div class="tooltip">
                                                            <label class="small mb-1" th:for="password">Password</label>
                                                            <input type="password" class="form-control form-control-user" th:field="*{password}"
                                                                   placeholder="패스워드">
                                                            <span class="tooltiptext tooltip-bottom">비밀번호는 8~16자 영문 대 소문자, 숫자, 특수문자를 사용해야 합니다.</span>
                                                        </div>

                                                        <div class="tooltip">
                                                            <label class="small mb-1" th:for="birth">Birth</label>
                                                            <input type="text" class="form-control form-control-user" th:field="*{birth}"
                                                                   placeholder="생년월일">
                                                            <span class="tooltiptext tooltip-bottom">8자리 형식으로 입력해 주세요. (ex:19910101)</span>
                                                        </div>

                                                        <div class="tooltip">
                                                            <label class="small mb-1" th:for="phone">Phone number</label>
                                                            <input type="text" class="form-control form-control-user" th:field="*{phone}"
                                                                   placeholder="핸드폰 번호">
                                                            <span class="tooltiptext tooltip-bottom">'-'은 제외하고 입력해 주세요. (ex:01012345678)</span>
                                                        </div>

                                                        <div class="tooltip">
                                                            <label class="small mb-1" th:for="email">Email</label>
                                                            <input type="text" class="form-control form-control-user" th:field="*{email}"
                                                                   placeholder="이메일">
                                                            <span class="tooltiptext tooltip-bottom">이메일 형식으로 입력해 주세요. (ex:abcd@gmail.com)</span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row gx-3 mb-3">
                                                    <div class="col-md-6">
                                                        <label class="small mb-1" th:for="address">address</label>
                                                        <div style="display: flex;">
                                                            <input type="text" class="form-control form-control-user" id="address" name="address" th:field="*{address}" placeholder="주소" style="flex: 1;">
                                                            <button onclick="searchAddress()" id="addressSearch" style="margin-right: 20px;">주소 찾기</button>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label class="small mb-1" th:for="bank">Bank account</label>
                                                        <input type="text" class="form-control form-control-user" th:field="*{bank}"
                                                               placeholder="계좌번호">
                                                    </div>
                                                </div>

                                                <div class="row gx-3 mb-3">
                                                    <div class="col-md-4">
                                                        <label class="small mb-1" th:for="department">Department</label>
                                                        <select class="custom-select" name="department" th:field="*{department}">
                                                            <option value="" selected="selected">부서</option>
                                                            <option value="생산직">생산팀</option>
                                                            <option value="구매팀">구매팀</option>
                                                            <option value="물류팀">물류팀</option>
                                                            <option value="EA팀">EA팀</option>
                                                            <option value="재무팀">재무팀</option>
                                                            <option value="임원">임원</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="small mb-1" th:for="position">Spot</label>
                                                        <select class="custom-select" name="position"  th:field="*{position}">
                                                            <option value="" selected="selected">직위</option>
                                                            <option value="사원">사원</option>
                                                            <option value="대리">대리</option>
                                                            <option value="과장">과장</option>
                                                            <option value="차장">차장</option>
                                                            <option value="부장" >부장</option>
                                                            <option value="이사">이사</option>
                                                            <option value="부사장">부사장</option>
                                                            <option value="사장">사장</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="small mb-1" th:for="hobong">Rank</label>
                                                        <select class="custom-select" name="hobong" th:field="*{hobong}">
                                                            <option value="" selected="selected">직급</option>
                                                            <option value="1호봉">1호봉</option>
                                                            <option value="2호봉">2호봉</option>
                                                            <option value="3호봉">3호봉</option>
                                                            <option value="4호봉">4호봉</option>
                                                            <option value="5호봉">5호봉</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="row gx-3 mb-3">
                                                    <div class="col-md-4">
                                                        <div class="tooltip">
                                                            <label class="small mb-1" th:for="date">Joining date</label>
                                                            <input type="date" class="form-control form-control-user" id="date" name="date" th:field="*{date}">
                                                            <span class="tooltiptext tooltip-bottom">입사날짜를 선택해 주세요.</span>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="small mb-1" th:for="status">Employment status</label>
                                                        <select class="custom-select" name="status" th:field="*{status}">
                                                            <option value="" selected="selected">재직현황</option>
                                                            <option value="WORKING">재직</option>
                                                            <option value="LEAVE">퇴사</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="small mb-1" th:for="role">Role</label>
                                                        <select class="custom-select" name="role" th:field="*{role}">
                                                            <option value="" selected="selected">구분</option>
                                                            <option value="USER">사용자</option>
                                                            <option value="ADMIN">관리자</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="button-container">
                                                    <button type="submit" style="width:150px;" class="btn btn-background-brown btn-user btn-block" onclick="return sweetAlert(event);">
                                                        Confirm
                                                    </button>
                                                </div>
                                                <!--            보안 관련 인증 토큰을 히든 파라미터로 보내줍니다-->
                                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 급여 리스트 폼-->
            <div class="col-lg-7">
                <div class="card-body p-51">
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-brown">Pay List</h6>
                        </div>
                        <div class="card-body5">
                            <form th:action="@{'/members/admin/detail/' + ${memberDetailDto.id}}" role="form" method="get" th:object="${memberPayList}">
                                <div class="scrollBar2">
                                    <table class="table table-bordered dataTable" id="dataTable" cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%; text-align: right;">

                                        <thead id="scroll-sticky">
                                        <tr role="row">
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1" aria-label="Id: activate to sort column ascending" style="width: 15%;" aria-sort="descending">
                                                지급연월
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1" aria-label="Name: activate to sort column ascending" style="width: 23%;">
                                                지급총액
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1" aria-label="Name: activate to sort column ascending" style="width: 23%;">
                                                공제총액
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1" aria-label="Name: activate to sort column ascending" style="width: 24%;">
                                                차감지급액
                                            </th>

                                        </tr>
                                        </thead>

                                        <tbody>
                                        <tr class="odd" th:each="bean, status: ${memberPayList}" onclick="handleRowClick(this)">
                                            <td id="xxx" class="sorting_1" th:text="|${bean.regDate.getYear() % 100}년 ${#numbers.formatInteger(bean.regDate.getMonthValue(), '02')}월|"></td>
                                            <td class="pp" th:text="${bean.plusMoney}"></td>
                                            <td class="mm" th:text="${bean.minusMoney}"></td>
                                            <td class="tt" th:text="${bean.TotalMoney}"></td>
                                            <td id="payId" style="display: none;" th:text="${bean.id}"></td>

                                            <td style="display: none;" th:text="${bean.salary}"></td>
                                            <td style="display: none;" th:text="${bean.bonus}"></td>
                                            <td style="display: none;" th:text="${bean.nightPay}"></td>
                                            <td style="display: none;" th:text="${bean.foodPay}"></td>
                                            <td style="display: none;" th:text="${bean.carPay}"></td>
                                            <td style="display: none;" th:text="${bean.goInsurance}"></td>
                                            <td style="display: none;" th:text="${bean.gunInsurance}"></td>
                                            <td style="display: none;" th:text="${bean.sanInsurance}"></td>
                                            <td style="display: none;" th:text="${bean.kukInsurance}"></td>
                                            <td style="display: none;" th:text="${bean.incomeTax}"></td>
                                            <td style="display: none;" th:text="${bean.localTax}"></td>
                                            <td style="display: none;" th:text="${bean.member.id}"></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <div class="button-container">
                                    <button type="button" class="btn btn-background-brown btn-user" style="width:150px;" onclick="openModal2()">
                                        Pay
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- 급여 등록 폼 -->
                    <div id="myModal2" class="modal2">
                        <div class="modal-content2">

                            <div class="card o-hidden border-0 shadow-lg my-2">
                                <form th:action="@{'/members/admin/payInsertNew/' + ${memberPayInsertDto.id}}" role="form" method="post" th:object="${memberPayInsertDto}">
                                    <div class="card-header py-3">
                                        <h4 id="datetitle" class="m-0 font-weight-bold text-brown" style="text-align: center;"></h4> <!-- 00년00월 급여명세서 -->
                                    </div>
                                    <div class="close-button" onclick="closeModal2()"><i class="fa-solid fa-xmark"></i></div>
                                    <div class="card-body3">
                                        <div class="row">

                                            <div class="col-lg-6 d-none d-lg-block">
                                                <div class="p-52" style="text-align:right;">

                                                    <table class="table-bordered dataTable" cellspacing="0" role="grid"  style="text-align:center; width: 515px;">
                                                        <tbody>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">사번</td>
                                                            <td style="text-align:center;"><label th:text="*{id}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">이름</td>
                                                            <td style="text-align:center;"><label th:text="*{name}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">생년월일</td>
                                                            <td style="text-align:center;"><label th:text="*{birth}"></label></td>
                                                        </tr>
                                                        </tbody>
                                                    </table>

                                                </div>
                                            </div>

                                            <div class="col-lg-6">
                                                <div class="p-52" style="text-align:right;">

                                                    <table class="table-bordered dataTable" cellspacing="0" role="grid"  style="text-align:center; width: 515px;">
                                                        <tbody>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">부서</td>
                                                            <td style="text-align:center;"><label th:text="*{department}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">직위</td>
                                                            <td style="text-align:center;"><label th:text="*{position}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">계좌번호</td>
                                                            <td style="text-align:center;"><label th:text="*{bank}"></label></td>
                                                        </tr>
                                                        </tbody>
                                                    </table>

                                                </div>
                                            </div>

                                        </div>

                                        <div class="card-body p-0612-1">
                                            <!-- Nested Row within Card Body -->

                                            <div class="row">
                                                <div class="col-lg-6 d-none d-lg-block">

                                                    <div class="p-52">
                                                        <table class="table table-bordered dataTable" id="dataTable1" width="100%" cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                                            <thead>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" colspan="2" style="text-align: center;">
                                                                    지급 항목
                                                                </td>
                                                            </tr>
                                                            </thead>

                                                            <tbody>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">기본급</td>
                                                                <td><input name="salary" id="salary" oninput="calculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{salary}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="기본급을(를) 입력해주세요."></td>
                                                                <input th:field="*{salary}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">상여금</td>
                                                                <td><input name="bonus" id="bonus" oninput="calculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{bonus}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="상여금을(를) 입력해주세요."></td>
                                                                <input th:field="*{bonus}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">야근수당</td>
                                                                <td><input name="nightPay" id="nightPay" oninput="calculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{nightPay}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="야근수당을(를) 입력해주세요."></td>
                                                                <input th:field="*{nightPay}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">식비</td>
                                                                <td><input name="foodPay" id="foodPay" oninput="calculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{foodPay}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="식비을(를) 입력해주세요."></td>
                                                                <input th:field="*{foodPay}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">차량지원금</td>
                                                                <td><input name="carPay" id="carPay" oninput="calculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{carPay}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="차량지원금을(를) 입력해주세요."></td>
                                                                <input th:field="*{carPay}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;"></td>
                                                                <td><input style="text-align:right;" type="text" disabled class="form-control" ></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;"></td>
                                                                <td><input style="text-align:right;" type="text" disabled  class="form-control" ></td>
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">지급총액</td>
                                                                <td class="font-weight-bold background-color-white" name="totalPrice" id="totalPrice" th:field="*{plusMoney}" style="text-align: right; height:39px;">0원</td>
                                                                <input th:field="*{plusMoney}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div>

                                                <div class="col-lg-6">
                                                    <div class="p-52">
                                                        <table class="table table-bordered dataTable" id="dataTable2" width="100%" cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                                            <thead>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" colspan="2" style="text-align: center;">
                                                                    공제 항목
                                                                </td>
                                                            </tr>
                                                            </thead>

                                                            <tbody>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">고용보험</td>
                                                                <td id="goInsurance" th:field="*{goInsurance}" style="text-align: right;" type="text" class="font-weight" placeholder="고용보험을(를) 입력해주세요."></td>
                                                                <input name="goInsurance" th:field="*{goInsurance}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">건강보험</td>
                                                                <td id="gunInsurance" th:field="*{gunInsurance}" style="text-align: right;" type="text" class="font-weight" placeholder="건강보험을(를) 입력해주세요."></td>
                                                                <input name="gunInsurance" th:field="*{gunInsurance}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">산재보험</td>
                                                                <td id="sanInsurance" th:field="*{sanInsurance}" style="text-align: right;" type="text" class="font-weight" placeholder="기건강보험을(를) 입력해주세요."></td>
                                                                <input name="sanInsurance" th:field="*{sanInsurance}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">국민연금</td>
                                                                <td id="kukInsurance" th:field="*{kukInsurance}" style="text-align: right;" type="text" class="font-weight" placeholder="국민연금을(를) 입력해주세요."></td>
                                                                <input name="kukInsurance" th:field="*{kukInsurance}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">소득세</td>
                                                                <td id="incomeTax" th:field="*{incomeTax}" style="text-align: right;" type="text" class="font-weight" placeholder="소득세세을(를) 입력해주세요."></td>
                                                                <input name="incomeTax" th:field="*{incomeTax}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">지방소득세</td>
                                                                <td id="localTax" th:field="*{localTax}" style="text-align: right;" type="text" class="font-weight" placeholder="지방소득세을(를) 입력해주세요."></td>
                                                                <input name="localTax" th:field="*{localTax}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>

                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">공제총액</td>
                                                                <td class="font-weight-bold background-color-white" name="totalPrice2" id="totalPrice2" th:field="*{minusMoney}" style="text-align: right;">0원</td>
                                                                <input name="minusMoney" th:field="*{minusMoney}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">차감지급액</td>
                                                                <td class="font-weight-bold background-color-white" id="deductionTotal" th:field="*{TotalMoney}" style="text-align: right;">0원</td>
                                                                <input th:field="*{TotalMoney}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                        <!--            보안 관련 인증 토큰을 히든 파라미터로 보내줍니다-->
                                                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-background-brown btn-user btn-block" style="width:150px; float: right;" onclick="return sweetAlert2(event); ">
                                            Confirm
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- 급여 등록 폼 닫음 -->


                    <!-- 급여 수정 등록 폼 -->
                    <div id="myModal4" class="modal4">
                        <div class="modal-content4">
                            <div class="card o-hidden border-0 shadow-lg my-2">
                                <form id="myForm" th:action="@{'/members/admin/payInsertNew/' + ${memberPayUpdateDto.id}}" role="form" method="post" th:object="${memberPayUpdateDto}">
                                    <div class="card-header py-3">
                                        <h4 id="updateRegdate" class="m-0 font-weight-bold text-brown" style="text-align: center;"></h4>
                                    </div>
                                    <div class="close-button" onclick="closeModal4()"><i class="fa-solid fa-xmark"></i></div>
                                    <div class="card-body3">
                                        <div class="row">

                                            <div class="col-lg-6 d-none d-lg-block">
                                                <div class="p-52" style="text-align:right;">

                                                    <table class="table-bordered dataTable" cellspacing="0" role="grid" style="text-align:center; width: 515px;">
                                                        <tbody>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">사번</td>
                                                            <td style="text-align:center;"><label th:text="*{id}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">이름</td>
                                                            <td style="text-align:center;"><label th:text="*{name}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">생년월일</td>
                                                            <td style="text-align:center;"><label th:text="*{birth}"></label></td>
                                                        </tr>
                                                        </tbody>
                                                    </table>

                                                </div>
                                            </div>

                                            <div class="col-lg-6">
                                                <div class="p-52" style="text-align:right;">

                                                    <table class="table-bordered dataTable" cellspacing="0" role="grid"  style="text-align:center; width: 515px;">
                                                        <tbody>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">부서</td>
                                                            <td style="text-align:center;"><label th:text="*{department}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">직위</td>
                                                            <td style="text-align:center;"><label th:text="*{position}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">계좌번호</td>
                                                            <td style="text-align:center;"><label th:text="*{bank}"></label></td>
                                                        </tr>
                                                        </tbody>
                                                    </table>

                                                </div>
                                            </div>

                                        </div>

                                        <div class="card-body p-0612-1">
                                            <!-- Nested Row within Card Body -->

                                            <div class="row">
                                                <div class="col-lg-6 d-none d-lg-block">

                                                    <div class="p-52">
                                                        <table class="table table-bordered dataTable" id="payUpdateTable1" width="100%" cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                                            <thead>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" colspan="2" style="text-align: center;">
                                                                    지급 항목
                                                                </td>
                                                            </tr>
                                                            </thead>

                                                            <tbody>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">기본급</td>
                                                                <td><input name="salaryUpdate" id="salaryUpdate" oninput="updateCalculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{salary}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="기본급을(를) 입력해주세요."></td>
                                                                <input th:field="*{salary}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">상여금</td>
                                                                <td><input name="bonusUpdate" id="bonusUpdate" oninput="updateCalculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{bonus}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="상여금을(를) 입력해주세요."></td>
                                                                <input th:field="*{bonus}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">야근수당</td>
                                                                <td><input name="nightPayUpdate" id="nightPayUpdate" oninput="updateCalculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{nightPay}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="야근수당을(를) 입력해주세요."></td>
                                                                <input th:field="*{nightPay}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">식비</td>
                                                                <td><input name="foodPayUpdate" id="foodPayUpdate" oninput="updateCalculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{foodPay}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="식비을(를) 입력해주세요."></td>
                                                                <input th:field="*{foodPay}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">차량지원금</td>
                                                                <td><input name="carPayUpdate" id="carPayUpdate" oninput="updateCalculateTotal()" onchange="this.value=formatNumber(this.value)" th:field="*{carPay}" style="text-align:right; height:39px;" type="text" class="form-control" placeholder="차량지원금을(를) 입력해주세요."></td>
                                                                <input th:field="*{carPay}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;"></td>
                                                                <td><input style="text-align:right;" type="text" disabled class="form-control" ></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;"></td>
                                                                <td><input style="text-align:right;" type="text" disabled  class="form-control" ></td>
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left;">지급총액</td>
                                                                <td class="font-weight-bold background-color-white" name="updateplusMoney" id="payUpdateTotal" th:field="*{plusMoney}" style="text-align: right;">0원</td>
                                                                <input th:field="*{plusMoney}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div>

                                                <div class="col-lg-6">
                                                    <div class="p-52">
                                                        <table class="table table-bordered dataTable" id="payUpdateTable2" width="100%" cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                                            <thead>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" colspan="2" style="text-align: center;">
                                                                    공제 항목
                                                                </td>
                                                            </tr>
                                                            </thead>

                                                            <tbody>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">고용보험</td>
                                                                <td id="goInsuranceUpdate" th:field="*{goInsurance}" style="text-align: right;" type="text" class="font-weight" placeholder="고용보험을(를) 입력해주세요."></td>
                                                                <input name="goInsuranceUpdate" th:field="*{goInsurance}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">건강보험</td>
                                                                <td id="gunInsuranceUpdate" th:field="*{gunInsurance}" style="text-align: right;" type="text" class="font-weight" placeholder="건강보험을(를) 입력해주세요."></td>
                                                                <input name="gunInsuranceUpdate" th:field="*{gunInsurance}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">산재보험</td>
                                                                <td id="sanInsuranceUpdate" th:field="*{sanInsurance}" style="text-align: right;" type="text" class="font-weight" placeholder="기건강보험을(를) 입력해주세요."></td>
                                                                <input name="sanInsuranceUpdate" th:field="*{sanInsurance}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">국민연금</td>
                                                                <td id="kukInsuranceUpdate" th:field="*{kukInsurance}" style="text-align: right;" type="text" class="font-weight" placeholder="국민연금을(를) 입력해주세요."></td>
                                                                <input name="kukInsuranceUpdate" th:field="*{kukInsurance}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">소득세</td>
                                                                <td id="incomeTaxUpdate" th:field="*{incomeTax}" style="text-align: right;" type="text" class="font-weight" placeholder="소득세세을(를) 입력해주세요."></td>
                                                                <input name="incomeTaxUpdate" th:field="*{incomeTax}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">지방소득세</td>
                                                                <td id="localTaxUpdate" th:field="*{localTax}" style="text-align: right;" type="text" class="font-weight" placeholder="지방소득세을(를) 입력해주세요."></td>
                                                                <input name="localTaxUpdate" th:field="*{localTax}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>

                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">공제총액</td>
                                                                <td class="font-weight-bold background-color-white" name="totalPrice2" id="updateMinusMoney" th:field="*{minusMoney}" style="text-align: right;">0원</td>
                                                                <input name="updateMinusMoney" th:field="*{minusMoney}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px;">차감지급액</td>
                                                                <td class="font-weight-bold background-color-white" id="deductionTotal2" th:field="*{TotalMoney}" style="text-align: right;">0원</td>
                                                                <input name="updateTotalMoney" th:field="*{TotalMoney}" style="text-align: right;" type="hidden" class="form-control">
                                                            </tr>
                                                            </tbody>
                                                        </table>

                                                        <!--            보안 관련 인증 토큰을 히든 파라미터로 보내줍니다-->
                                                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-background-brown btn-user btn-block" style="width:150px; float: right;" onclick="return sweetAlert3(event); ">
                                            저장
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- 급여 수정 등록 폼 닫음 -->



                    <!-- 급여 디테일 폼 -->
                    <div id="myModal3" class="modal3">
                        <div class="modal-content3">

                            <div class="card o-hidden border-0 shadow-lg my-2">
                                <form action="" role="form" method="post" th:object="${memberDetailDto}" enctype="multipart/form-data">
                                    <div class="card-header py-3">
                                        <h4 id="detailRegDate" class="m-0 font-weight-bold text-brown" style="text-align: center;"></h4>
                                    </div>
                                    <div class="close-button" onclick="closeModal3()"><i class="fa-solid fa-xmark"></i></div>
                                    <div class="card-body3">
                                        <div class="row">

                                            <div class="col-lg-6 d-none d-lg-block">
                                                <div class="p-52" style="text-align:right;">
                                                    <table class="table-bordered dataTable" cellspacing="0" role="grid"  style="text-align:center; width: 515px;">
                                                        <tbody>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">사번</td>
                                                            <td style="text-align:center;"><label th:text="*{id}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">이름</td>
                                                            <td style="text-align:center;"><label th:text="*{name}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">생년월일</td>
                                                            <td style="text-align:center;"><label th:text="*{birth}"></label></td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>

                                            <div class="col-lg-6">
                                                <div class="p-52" style="text-align:right;">
                                                    <table class="table-bordered dataTable" cellspacing="0" role="grid"  style="text-align:center; width: 515px;">
                                                        <tbody>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">부서</td>
                                                            <td style="text-align:center;"><label th:text="*{department}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">직위</td>
                                                            <td style="text-align:center;"><label th:text="*{position}"></label></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="text-brown font-weight-bold background-color-white" style="width:150px;">계좌번호</td>
                                                            <td style="text-align:center;"><label th:text="*{bank}"></label></td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>



                                        <div class="card-body p-0612-1">
                                            <!-- Nested Row within Card Body -->
                                            <div class="row">
                                                <div class="col-lg-6 d-none d-lg-block">
                                                    <div class="p-52">
                                                        <table class="table table-bordered dataTable" width="100%" cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                                            <thead>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" colspan="2" style="text-align: center;">
                                                                    지급 항목
                                                                </td>
                                                            </tr>
                                                            </thead>

                                                            <tbody>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px; height:39px;">기본급</td>
                                                                <td style="text-align:right;"><span id="detailSalary"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">상여금</td>
                                                                <td style="text-align:right;"><span id="detailBonus"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">야근수당</td>
                                                                <td style="text-align:right;"><span id="detailNightPay"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">식비</td>
                                                                <td style="text-align:right;"><span id="detailFoodPay"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">차량지원금</td>
                                                                <td style="text-align:right;"><span id="detailCarPay"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;"></td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;"></td>
                                                                <td></td>
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">지급총액</td>
                                                                <td class="font-weight-bold background-color-white" style="text-align:right;"><span id="detailPlusMoney"></span></td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>


                                                <div class="col-lg-6" >
                                                    <div class="p-52">
                                                        <table class="table table-bordered dataTable"  width="100%" cellspacing="0" role="grid" aria-describedby="dataTable_info" style="width: 100%;">
                                                            <thead>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" colspan="2" style="text-align: center;">
                                                                    공제 항목
                                                                </td>
                                                            </tr>
                                                            </thead>

                                                            <tbody>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; width:128px; height:39px;">고용보험</td>
                                                                <td style="text-align:right;"><span id="detailGoInsurance"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">건강보험</td>
                                                                <td style="text-align:right;"><span id="detailGunInsurance"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">산재보험</td>
                                                                <td style="text-align:right;"><span id="detailSanInsurance"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">국민연금</td>
                                                                <td style="text-align:right;"><span id="detailKukInsurance"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">소득세</td>
                                                                <td style="text-align:right;"><span id="detailIncomeTax"></span></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="text-brown font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">지방소득세</td>
                                                                <td style="text-align:right;"><span id="detailLocalTax"></span></td>
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">공제총액</td>
                                                                <td class="font-weight-bold background-color-white" style="text-align:right;"><span id="detailMinusMoney"></span></td>
                                                            </tr>
                                                            <tr style="height:64px;">
                                                                <td class="font-weight-bold background-color-white" style="vertical-align: middle; text-align:left; height:39px;">차감지급액</td>
                                                                <td class="font-weight-bold background-color-white" style="text-align:right;"><span id="detailTotalMoney"></span></td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                        <!--            보안 관련 인증 토큰을 히든 파라미터로 보내줍니다-->
                                                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="button" class="btn btn-background-brown btn-user btn-block" style="width:150px; float: right;" onclick="openModal4(); closeModal3(); updateCalculateTotal();">
                                            Edit
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- 급여 디테일 폼 닫음 -->
                </div>
            </div>
        </div>
    </div>
    </body>
</div>
</html>